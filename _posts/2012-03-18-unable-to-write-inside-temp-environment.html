---
layout: post
title: Unable to write inside TEMP environment variable path
date: '2012-03-18T00:00:00.000Z'
author: Igor Duarte Cardoso
tags:
- PostgreSQL
- Windows
modified_time: '2012-03-18T00:00:01.787Z'
thumbnail: http://3.bp.blogspot.com/-yn4F9RFVfyk/T2N8BhI93WI/AAAAAAAAAL0/qNdH0Xuor3U/s72-c/postgresql_error.png
blogger_id: tag:blogger.com,1999:blog-7503515668102711213.post-8742702889495398826
blogger_orig_url: http://igordcard.blogspot.com/2012/03/unable-to-write-inside-temp-environment.html
---

I stumbled upon this beautiful error when trying to re-install my PostgreSQL 9.1.3 server:&nbsp;<b>Unable to write inside TEMP environment variable path</b>.<br /><br />After some research and trial-and-terror [sic], I came to the conclusion that the essence of the problem had been a tiny change I made to my system's file associations (via Notepad++).<br /><br />Here's how I solved it and how you can do it too:<br /><br /><a name='more'></a><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"><a imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="103" src="../assets/postgresql_error.png" width="320" /></a></div><br />I first made some research in the existing community but the solutions I found did not apply to me (I provide some links at the end of the page to these solutions):<br /><ul><li>I checked if it was related to the option "Use temporary folders per session" in the "Remote Desktop Session Host Configuration";</li><li>I checked the status of "Windows Script Host Settings" (<code>whost.exe</code>);</li><li>I completely skipped antivirus-related stuff as I don't have any antivirus.</li></ul><br />So, to understand why this error was happening, I went to my TEMP folder and read the log from the PostgreSQL installer:<br /><br /><code>C:\Users\myuser\AppData\Local\Temp\bitrock_installer.log</code><br /><br />Which mentioned an interesting detail:<br /><ul><li>Input Error: There is no script engine for file extension ".vbs".</li></ul><div>So, I picked up another file from the TEMP folder, the actual script used by the installer:</div><br /><code>C:\Users\myuser\AppData\Local\Temp\prerun_checks.vbs</code><br /><br />And tried to run it through the console using <code>cscript</code>:<br /><br /><code>Input Error: There is no script engine for file extension ".vbs".</code><br /><br />The same!<br />I researched a bit more and discovered that the type of file associated with the <code>vbs</code> extension had been changed. In my case, by Notepad++. After I installed Notepad++, I associated some file extensions with it (including <code>vbs</code>), thus causing problems when detecting the type of the script (which shouldn't happen).<br /><br /><br /><b>Fixing it</b><br /><b><br /></b><br />Run the almighty <code>regedit</code>, navigate to <code>HKEY_CLASSES_ROOT\.vbs</code> and change the <code>(Default)</code> key back to the string <code>VBSFile</code>. In my case it had been previously altered to <code>Notepad++_file.</code><br /><div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="211" src="../assets/damaged_vbs_type.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">How the registry entries looked like before</td></tr></tbody></table><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="211" src="../assets/damaged_vbs_fixed.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">How the registry entries look when fixed</td></tr></tbody></table><br />Then, restart PostgreSQL's installer and everything should go fine.<br /><br /><br />This is just a possible pair of cause-solution. Other solutions can be reached via some of the links below, don't forget to check them if my post doesn't apply to your issue.<br /><br /><br />Useful links:<br /><a href="http://jamesmcdonald.id.au/it-tips/input-error-there-is-no-script-engine-for-file-extension-vbs">Input Error: There is no script engine for file extension “.vbs”.</a><br /><a href="http://commandwindows.com/scripts.htm">Running VBScript and JScript files from the Command Shell</a><br /><a href="http://social.technet.microsoft.com/Forums/en-US/windowsserver2008r2general/thread/01fc43a4-08b3-49c5-b265-60b819775194/">Temporary directory environment variable in Windows Server 2008</a><br /><a href="http://wiki.postgresql.org/wiki/Running_%26_Installing_PostgreSQL_On_Native_Windows">Running &amp; Installing PostgreSQL On Native Windows</a><br /><a href="http://wiki.postgresql.org/wiki/Troubleshooting_Installation">Collect the installer log file (PostgreSQL)</a><br /><a href="http://stackoverflow.com/questions/5224042/postgresql-9-install-on-winxp-unable-to-write-inside-temp-environment-path">Unable to write inside TEMP environment path</a><br /><br /></div>
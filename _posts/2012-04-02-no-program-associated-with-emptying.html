---
layout: post
title: No Program Associated with Emptying the Recycle Bin Error
date: '2012-04-02T17:41:00.001+01:00'
author: Igor Duarte Cardoso
tags:
- Windows
- Microsoft
- Fixes
modified_time: '2012-09-01T23:31:58.210+01:00'
thumbnail: http://3.bp.blogspot.com/-6f0ExnscApE/T3m2e04v_VI/AAAAAAAAANc/-8YAKg-dZDQ/s72-c/recycle-bin-error.png
blogger_id: tag:blogger.com,1999:blog-7503515668102711213.post-6313330269571949157
blogger_orig_url: http://igordcard.blogspot.com/2012/04/no-program-associated-with-emptying.html
---

When trying to empty the recycle bin in Microsoft Windows Vista/7/2008/2008 R2 (and probably XP, though it was not tested) via the "Empty the Recycle Bin" option, the following error appears:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-6f0ExnscApE/T3m2e04v_VI/AAAAAAAAANc/-8YAKg-dZDQ/s1600/recycle-bin-error.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="97" src="http://3.bp.blogspot.com/-6f0ExnscApE/T3m2e04v_VI/AAAAAAAAANc/-8YAKg-dZDQ/s320/recycle-bin-error.png" width="320" /></a></div><br /><a name='more'></a>I've had this problem in my Windows computer for a few months already but only now I decided to check what it was all about.<br /><br />For some reason, an important registry key disappeared from my operating system (which isn't statistically weird given that my Windows installation is already 28 months old).<br /><br />First, I made some research about this problem but it ended up non-conclusive and without solutions nor interesting workarounds.<br /><br />As such, I will show you how I managed to fix this issue:<br /><br /><br /><b>1.</b><br />I started searching for relevant entries about the recycle bin with the Registry Editor (<code>regedit</code>).<br /><br /><span style="color: #666666;">[You can run the Registry Editor by writing "regedit" in the start menu, then right-click the first result that appears and selecting "Run as administrator".]</span><br /><br />I stumbled upon the following suspicious key:<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-LXVDDD4IY6M/T3m24zOAeGI/AAAAAAAAANs/1mgfYwyWuIQ/s1600/regedit-before.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="153" src="http://3.bp.blogspot.com/-LXVDDD4IY6M/T3m24zOAeGI/AAAAAAAAANs/1mgfYwyWuIQ/s320/regedit-before.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><span style="font-size: small; text-align: -webkit-auto;"><code>HKEY_CLASSES_ROOT\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\empty\command</code></span></td></tr></tbody></table><br /><b>2.</b><br />I went to another computer I had working alright and searched for the same key to find out that the contents were different.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-30r_5WLJKII/T3m20YPHRwI/AAAAAAAAANk/ceYZJ1aBd6I/s1600/regedit-after.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="153" src="http://1.bp.blogspot.com/-30r_5WLJKII/T3m20YPHRwI/AAAAAAAAANk/ceYZJ1aBd6I/s320/regedit-after.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><span style="font-size: small; text-align: -webkit-auto;"><code>HKEY_CLASSES_ROOT\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\empty\command</code></span></td></tr></tbody></table><br /><b>3.</b><br />I just tried to copy the <code>DelegateExecute</code> String key to my bad Windows installation registry.<br /><br />However, I had no permissions to write in the original key because it's not supposed to be touched.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-acB2daFqn1c/T3m3LPwWiRI/AAAAAAAAAN0/hcxVYqNN54k/s1600/regedit-cannot.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="129" src="http://3.bp.blogspot.com/-acB2daFqn1c/T3m3LPwWiRI/AAAAAAAAAN0/hcxVYqNN54k/s320/regedit-cannot.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><span style="font-size: small; text-align: -webkit-auto;">When trying to add the missing key, permission was denied</span>&nbsp;</td></tr></tbody></table><br /><b>4.</b><br />I used the amazing RegDACL program from Frank Heyne&nbsp;to unlock the key:<br /><br />In a Windows Command Prompt (or PowerShell) execute the following command (having RegDACL in either the path or the current directory):<br /><br /><span style="color: #666666;">[You can run the Command Prompt by writing "cmd" in the start menu, then right-click the first result that appears and selecting "Run as administrator".]</span><br /><br /><code>RegDACL.exe HKCR\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\empty\command /GGA:W(NI)</code><br /><br />Now it should be possible to change the registry key (if you do it as Administrator):<br /><br /><pre style="border: 1px solid black;">C:\&gt;RegDACL.exe HKCR\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\empty\command /GGA:F(CI)<br /><br /><br /><br />RegDACL 6.2 - Permissions Manager for Registry keys for Windows<br /><br />Copyright (c) 1999-2007 Frank Heyne Software (http://www.heysoft.de)<br /><br />This program is Freeware, use it on your own risk!<br /><br /><br /><br /><br /><br />Granting "W(NI)" access for predefined group "Administrators"<br /><br />&nbsp;- adding new entry<br /></pre><br />Don't forget to restore the original permissions afterwards.<br /><br /><b>5.</b><br />Finally I just added a String key named: <code>DelegateExecute</code> with the content: <code>{48527bb3-e8de-450b-8910-8c4099cb8624}</code>, or use the <code>.reg</code> inside the previous key (<code>HKEY_CLASSES_ROOT\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\empty\command</code>) file I provide at the end of this post.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-5o1unXQx5wg/T3m3UEASHXI/AAAAAAAAAN8/tl_bwh8g-q8/s1600/regedit-after.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="153" src="http://1.bp.blogspot.com/-5o1unXQx5wg/T3m3UEASHXI/AAAAAAAAAN8/tl_bwh8g-q8/s320/regedit-after.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><span style="font-size: small; text-align: -webkit-auto;">It should look like this after adding the missing key</span></td></tr></tbody></table><br /><br />The problem should now be fixed, if you go to the "Empty the Recycle Bin" option you'll see the familiar dialog:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-KfzFWhI6AOc/T3m3deHaf1I/AAAAAAAAAOE/-qmD6ABSRek/s1600/recycle-bin-working.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="169" src="http://3.bp.blogspot.com/-KfzFWhI6AOc/T3m3deHaf1I/AAAAAAAAAOE/-qmD6ABSRek/s320/recycle-bin-working.png" width="320" /></a></div><br /><br />One more thing. I had a backup key in my computer made by the trial TuneUp Utilities 2012, so it may have been the cause of this issue.<br /><br /><b>Update of 2012-04-19:</b><br /><br /><b>Download the .reg file that fixes the key automatically: <a href="http://igordcard.googlecode.com/files/DelegateExecute.reg">DelegateExecute.reg</a></b><br />(you still need to apply the permissions explained earlier)<br /><br />Useful links:<br /><a href="http://www.heysoft.de/en/software/regtools.php">RegDACL</a>